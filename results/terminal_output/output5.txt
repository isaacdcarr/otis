Sat 12 Oct 2019 12:25:10 AEDT
Using TensorFlow backend.
== Starting Otis ==
... hyperparams
...    targ_w:	224
...    targ_h:	224
... obtaining normal train data
... ... Processed 1342 images
... obtaining pneumonia train data
... ... Processed 3876 images
... obtaining normal test data
... ... Processed 234 images
... obtaining pneumonia tests data
... ... Processed 390 images
... obtaining val train data
... ... Processed 9 images
... obtaining pneumonia val data
... ... Processed 9 images
... define model
2019-10-12 12:26:37.646659: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-10-12 12:26:37.692946: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7f9e6c418850 executing computations on platform Host. Devices:
2019-10-12 12:26:37.692979: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): Host, Default Version
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
conv2d_1 (Conv2D)            (None, 224, 224, 32)      832
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 112, 112, 32)      0
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 112, 112, 6)       4806
_________________________________________________________________
max_pooling2d_2 (MaxPooling2 (None, 56, 56, 6)         0
_________________________________________________________________
flatten_1 (Flatten)          (None, 18816)             0
_________________________________________________________________
dense_1 (Dense)              (None, 1024)              19268608
_________________________________________________________________
dense_2 (Dense)              (None, 2)                 2050
=================================================================
Total params: 19,276,296
Trainable params: 19,276,296
Non-trainable params: 0
_________________________________________________________________
None
>>> For epochs: 10
... fit model
Train on 5216 samples, validate on 624 samples
Epoch 1/10
5216/5216 [==============================] - 363s 70ms/step - loss: 29.5957 - accuracy: 0.8453 - val_loss: 0.8546 - val_accuracy: 0.7997
Epoch 2/10
5216/5216 [==============================] - 355s 68ms/step - loss: 0.1959 - accuracy: 0.9243 - val_loss: 1.1919 - val_accuracy: 0.8173
Epoch 3/10
5216/5216 [==============================] - 351s 67ms/step - loss: 0.0997 - accuracy: 0.9605 - val_loss: 1.1136 - val_accuracy: 0.7837
Epoch 4/10
5216/5216 [==============================] - 348s 67ms/step - loss: 0.0766 - accuracy: 0.9730 - val_loss: 2.0860 - val_accuracy: 0.7500
Epoch 5/10
5216/5216 [==============================] - 351s 67ms/step - loss: 0.0692 - accuracy: 0.9755 - val_loss: 2.2611 - val_accuracy: 0.7580
Epoch 6/10
5216/5216 [==============================] - 349s 67ms/step - loss: 0.0596 - accuracy: 0.9804 - val_loss: 2.6629 - val_accuracy: 0.7500
Epoch 7/10
5216/5216 [==============================] - 349s 67ms/step - loss: 0.0236 - accuracy: 0.9929 - val_loss: 2.4562 - val_accuracy: 0.7468
Epoch 8/10
5216/5216 [==============================] - 348s 67ms/step - loss: 0.0133 - accuracy: 0.9956 - val_loss: 3.2748 - val_accuracy: 0.7372
Epoch 9/10
5216/5216 [==============================] - 345s 66ms/step - loss: 0.0270 - accuracy: 0.9942 - val_loss: 2.7554 - val_accuracy: 0.7500
Epoch 10/10
5216/5216 [==============================] - 346s 66ms/step - loss: 0.0549 - accuracy: 0.9799 - val_loss: 4.1620 - val_accuracy: 0.7580
Saved history as str
624/624 [==============================] - 9s 15ms/step
[4.1620285024670585, 0.7580128312110901]
>>> For epochs: 15
... fit model
Train on 5216 samples, validate on 624 samples
Epoch 1/15
5216/5216 [==============================] - 349s 67ms/step - loss: 0.0293 - accuracy: 0.9923 - val_loss: 2.9836 - val_accuracy: 0.7420
Epoch 2/15
5216/5216 [==============================] - 348s 67ms/step - loss: 0.0175 - accuracy: 0.9941 - val_loss: 4.2452 - val_accuracy: 0.7404
Epoch 3/15
5216/5216 [==============================] - 348s 67ms/step - loss: 0.0097 - accuracy: 0.9964 - val_loss: 5.7806 - val_accuracy: 0.7532
Epoch 4/15
5216/5216 [==============================] - 347s 66ms/step - loss: 0.0041 - accuracy: 0.9987 - val_loss: 4.8496 - val_accuracy: 0.7372
Epoch 5/15
5216/5216 [==============================] - 346s 66ms/step - loss: 0.0013 - accuracy: 0.9994 - val_loss: 4.6649 - val_accuracy: 0.7580
Epoch 6/15
5216/5216 [==============================] - 347s 67ms/step - loss: 2.2339e-04 - accuracy: 1.0000 - val_loss: 5.1875 - val_accuracy: 0.7548
Epoch 7/15
5216/5216 [==============================] - 346s 66ms/step - loss: 2.7267e-05 - accuracy: 1.0000 - val_loss: 5.3231 - val_accuracy: 0.7564
Epoch 8/15
5216/5216 [==============================] - 346s 66ms/step - loss: 1.3942e-05 - accuracy: 1.0000 - val_loss: 5.4698 - val_accuracy: 0.7564
Epoch 9/15
3616/5216 [===================>..........] - ETA: 1:45 - loss: 1.0625e-05 - accuracy: 1.0000^CTraceback (most recent call last):
  File "src/otis.py", line 196, in <module>
    main()
  File "src/otis.py", line 159, in main
    history_cnn = cnn.fit(X_train, y_train, epochs=epochs, verbose=1, validation_data=(X_test, y_test))
  File "/usr/local/lib/python3.7/site-packages/keras/engine/training.py", line 1239, in fit
    validation_freq=validation_freq)
  File "/usr/local/lib/python3.7/site-packages/keras/engine/training_arrays.py", line 196, in fit_loop
    outs = fit_function(ins_batch)
  File "/usr/local/lib/python3.7/site-packages/tensorflow_core/python/keras/backend.py", line 3740, in __call__
    outputs = self._graph_fn(*converted_inputs)
  File "/usr/local/lib/python3.7/site-packages/tensorflow_core/python/eager/function.py", line 1081, in __call__
    return self._call_impl(args, kwargs)
  File "/usr/local/lib/python3.7/site-packages/tensorflow_core/python/eager/function.py", line 1121, in _call_impl
    return self._call_flat(args, self.captured_inputs, cancellation_manager)
  File "/usr/local/lib/python3.7/site-packages/tensorflow_core/python/eager/function.py", line 1224, in _call_flat
    ctx, args, cancellation_manager=cancellation_manager)
  File "/usr/local/lib/python3.7/site-packages/tensorflow_core/python/eager/function.py", line 511, in call
    ctx=ctx)
  File "/usr/local/lib/python3.7/site-packages/tensorflow_core/python/eager/execute.py", line 61, in quick_execute
    num_outputs)
KeyboardInterrupt
 ✘ isaac@192-168-1-6  ~/r/otis   master ●  ./run
Sat 12 Oct 2019 14:16:30 AEDT
Using TensorFlow backend.
== Starting Otis ==
... hyperparams
...    targ_w:	224
...    targ_h:	224
... obtaining normal train data
... ... Processed 1342 images
... obtaining pneumonia train data
... ... Processed 3876 images
... obtaining normal test data
... ... Processed 234 images
... obtaining pneumonia tests data
... ... Processed 390 images
... obtaining val train data
... ... Processed 9 images
... obtaining pneumonia val data
... ... Processed 9 images
... define model
2019-10-12 14:17:52.540918: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2019-10-12 14:17:52.583404: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x7fa68d7ab6d0 executing computations on platform Host. Devices:
2019-10-12 14:17:52.583434: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): Host, Default Version
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
conv2d_1 (Conv2D)            (None, 224, 224, 32)      832
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 112, 112, 32)      0
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 112, 112, 6)       4806
_________________________________________________________________
max_pooling2d_2 (MaxPooling2 (None, 56, 56, 6)         0
_________________________________________________________________
flatten_1 (Flatten)          (None, 18816)             0
_________________________________________________________________
dense_1 (Dense)              (None, 1024)              19268608
_________________________________________________________________
dense_2 (Dense)              (None, 2)                 2050
=================================================================
Total params: 19,276,296
Trainable params: 19,276,296
Non-trainable params: 0
_________________________________________________________________
None
>>> For epochs: 10
... fit model
Train on 5216 samples, validate on 624 samples
Epoch 1/10
5216/5216 [==============================] - 353s 68ms/step - loss: 15.2067 - accuracy: 0.8543 - val_loss: 0.7597 - val_accuracy: 0.8077
Epoch 2/10
5216/5216 [==============================] - 350s 67ms/step - loss: 0.2488 - accuracy: 0.8976 - val_loss: 1.0339 - val_accuracy: 0.6939
Epoch 3/10
5216/5216 [==============================] - 349s 67ms/step - loss: 0.1771 - accuracy: 0.9268 - val_loss: 1.3257 - val_accuracy: 0.7484
Epoch 4/10
5216/5216 [==============================] - 350s 67ms/step - loss: 0.1298 - accuracy: 0.9465 - val_loss: 1.9892 - val_accuracy: 0.7196
Epoch 5/10
5216/5216 [==============================] - 350s 67ms/step - loss: 0.1480 - accuracy: 0.9423 - val_loss: 2.0491 - val_accuracy: 0.7051
Epoch 6/10
5216/5216 [==============================] - 347s 67ms/step - loss: 0.1277 - accuracy: 0.9477 - val_loss: 1.8582 - val_accuracy: 0.7179
Epoch 7/10
5216/5216 [==============================] - 350s 67ms/step - loss: 0.0957 - accuracy: 0.9640 - val_loss: 2.2588 - val_accuracy: 0.7324
Epoch 8/10
5216/5216 [==============================] - 348s 67ms/step - loss: 0.0606 - accuracy: 0.9753 - val_loss: 3.2627 - val_accuracy: 0.7244
Epoch 9/10
5216/5216 [==============================] - 347s 66ms/step - loss: 0.0517 - accuracy: 0.9810 - val_loss: 3.0941 - val_accuracy: 0.7404
Epoch 10/10
5216/5216 [==============================] - 347s 66ms/step - loss: 0.0662 - accuracy: 0.9778 - val_loss: 3.0554 - val_accuracy: 0.7404
Saved history as str
624/624 [==============================] - 9s 15ms/step
[3.055356302394126, 0.7403846383094788]
>>> For epochs: 15
... fit model
Train on 5216 samples, validate on 624 samples
Epoch 1/15
5216/5216 [==============================] - 348s 67ms/step - loss: 0.0512 - accuracy: 0.9810 - val_loss: 3.9925 - val_accuracy: 0.7196
Epoch 2/15
5216/5216 [==============================] - 349s 67ms/step - loss: 0.0427 - accuracy: 0.9881 - val_loss: 4.2002 - val_accuracy: 0.7308
Epoch 3/15
5216/5216 [==============================] - 350s 67ms/step - loss: 0.0468 - accuracy: 0.9862 - val_loss: 4.1207 - val_accuracy: 0.7212
Epoch 4/15
5216/5216 [==============================] - 349s 67ms/step - loss: 0.0526 - accuracy: 0.9862 - val_loss: 4.0413 - val_accuracy: 0.7388
Epoch 5/15
5216/5216 [==============================] - 349s 67ms/step - loss: 0.0995 - accuracy: 0.9680 - val_loss: 3.5035 - val_accuracy: 0.7260
Epoch 6/15
5216/5216 [==============================] - 349s 67ms/step - loss: 0.0676 - accuracy: 0.9785 - val_loss: 4.0716 - val_accuracy: 0.7212
Epoch 7/15
5216/5216 [==============================] - 350s 67ms/step - loss: 0.0642 - accuracy: 0.9785 - val_loss: 6.0537 - val_accuracy: 0.7228
Epoch 8/15
5216/5216 [==============================] - 348s 67ms/step - loss: 0.0341 - accuracy: 0.9891 - val_loss: 6.5340 - val_accuracy: 0.7484
Epoch 9/15
5216/5216 [==============================] - 349s 67ms/step - loss: 0.0167 - accuracy: 0.9941 - val_loss: 6.8416 - val_accuracy: 0.7356
Epoch 10/15
5216/5216 [==============================] - 349s 67ms/step - loss: 0.0105 - accuracy: 0.9956 - val_loss: 6.9217 - val_accuracy: 0.7420
Epoch 11/15
5216/5216 [==============================] - 356s 68ms/step - loss: 0.0081 - accuracy: 0.9977 - val_loss: 7.1481 - val_accuracy: 0.7420
Epoch 12/15
5216/5216 [==============================] - 360s 69ms/step - loss: 0.0165 - accuracy: 0.9952 - val_loss: 7.4386 - val_accuracy: 0.7404
Epoch 13/15
5216/5216 [==============================] - 347s 67ms/step - loss: 0.0070 - accuracy: 0.9979 - val_loss: 6.6640 - val_accuracy: 0.7644
Epoch 14/15
5216/5216 [==============================] - 350s 67ms/step - loss: 0.0240 - accuracy: 0.9933 - val_loss: 8.0956 - val_accuracy: 0.7436
Epoch 15/15
5216/5216 [==============================] - 350s 67ms/step - loss: 0.0411 - accuracy: 0.9883 - val_loss: 5.8913 - val_accuracy: 0.7452
Saved history as str
624/624 [==============================] - 9s 15ms/step
[5.891301341420517, 0.745192289352417]
>>> For epochs: 20
... fit model
Train on 5216 samples, validate on 624 samples
Epoch 1/20
5216/5216 [==============================] - 354s 68ms/step - loss: 0.1046 - accuracy: 0.9701 - val_loss: 4.8836 - val_accuracy: 0.7516
Epoch 2/20
5216/5216 [==============================] - 354s 68ms/step - loss: 0.0647 - accuracy: 0.9820 - val_loss: 4.8433 - val_accuracy: 0.7260
Epoch 3/20
5216/5216 [==============================] - 350s 67ms/step - loss: 0.0278 - accuracy: 0.9918 - val_loss: 5.7672 - val_accuracy: 0.7468
Epoch 4/20
5216/5216 [==============================] - 352s 68ms/step - loss: 0.0267 - accuracy: 0.9919 - val_loss: 5.9743 - val_accuracy: 0.7372
Epoch 5/20
5216/5216 [==============================] - 356s 68ms/step - loss: 0.0384 - accuracy: 0.9916 - val_loss: 4.9559 - val_accuracy: 0.7516
Epoch 6/20
5216/5216 [==============================] - 347s 66ms/step - loss: 0.0464 - accuracy: 0.9866 - val_loss: 5.2294 - val_accuracy: 0.7468
Epoch 7/20
5216/5216 [==============================] - 346s 66ms/step - loss: 0.0226 - accuracy: 0.9919 - val_loss: 5.7817 - val_accuracy: 0.7436
Epoch 8/20
5216/5216 [==============================] - 346s 66ms/step - loss: 0.0183 - accuracy: 0.9942 - val_loss: 5.1498 - val_accuracy: 0.7372
Epoch 9/20
5216/5216 [==============================] - 347s 67ms/step - loss: 0.0193 - accuracy: 0.9931 - val_loss: 6.1927 - val_accuracy: 0.7420
Epoch 10/20
5216/5216 [==============================] - 346s 66ms/step - loss: 0.0191 - accuracy: 0.9941 - val_loss: 6.4762 - val_accuracy: 0.7228
Epoch 11/20
5216/5216 [==============================] - 347s 67ms/step - loss: 0.0312 - accuracy: 0.9900 - val_loss: 6.5273 - val_accuracy: 0.7324
Epoch 12/20
5216/5216 [==============================] - 347s 67ms/step - loss: 0.0214 - accuracy: 0.9935 - val_loss: 6.5542 - val_accuracy: 0.7115
Epoch 13/20
5216/5216 [==============================] - 347s 66ms/step - loss: 0.0089 - accuracy: 0.9973 - val_loss: 7.8474 - val_accuracy: 0.7196
Epoch 14/20
5216/5216 [==============================] - 347s 66ms/step - loss: 0.0130 - accuracy: 0.9960 - val_loss: 7.4455 - val_accuracy: 0.6987
Epoch 15/20
5216/5216 [==============================] - 346s 66ms/step - loss: 0.0167 - accuracy: 0.9952 - val_loss: 9.0871 - val_accuracy: 0.7340
Epoch 16/20
5216/5216 [==============================] - 346s 66ms/step - loss: 0.0195 - accuracy: 0.9942 - val_loss: 9.1167 - val_accuracy: 0.7292
Epoch 17/20
5216/5216 [==============================] - 347s 67ms/step - loss: 0.0090 - accuracy: 0.9973 - val_loss: 8.9928 - val_accuracy: 0.7292
Epoch 18/20
5216/5216 [==============================] - 346s 66ms/step - loss: 0.0086 - accuracy: 0.9971 - val_loss: 9.7288 - val_accuracy: 0.7179
Epoch 19/20
5216/5216 [==============================] - 347s 66ms/step - loss: 0.0577 - accuracy: 0.9893 - val_loss: 9.1293 - val_accuracy: 0.7452
Epoch 20/20
5216/5216 [==============================] - 346s 66ms/step - loss: 0.0941 - accuracy: 0.9812 - val_loss: 6.7054 - val_accuracy: 0.7131
Saved history as str
624/624 [==============================] - 9s 15ms/step
[6.705388937761409, 0.7131410241127014]
>>> For epochs: 25
... fit model
Train on 5216 samples, validate on 624 samples
Epoch 1/25
1056/5216 [=====>........................] - ETA: 4:29 - loss: 0.0210 - accuracy: 0.9905^CTraceback (most recent call last):
  File "src/otis.py", line 198, in <module>
    main()
  File "src/otis.py", line 159, in main
    history_cnn = cnn.fit(X_train, y_train, epochs=epochs, verbose=1, validation_data=(X_test, y_test))
  File "/usr/local/lib/python3.7/site-packages/keras/engine/training.py", line 1239, in fit
    validation_freq=validation_freq)
  File "/usr/local/lib/python3.7/site-packages/keras/engine/training_arrays.py", line 196, in fit_loop
    outs = fit_function(ins_batch)
  File "/usr/local/lib/python3.7/site-packages/tensorflow_core/python/keras/backend.py", line 3740, in __call__
    outputs = self._graph_fn(*converted_inputs)
  File "/usr/local/lib/python3.7/site-packages/tensorflow_core/python/eager/function.py", line 1081, in __call__
    return self._call_impl(args, kwargs)
  File "/usr/local/lib/python3.7/site-packages/tensorflow_core/python/eager/function.py", line 1121, in _call_impl
    return self._call_flat(args, self.captured_inputs, cancellation_manager)
  File "/usr/local/lib/python3.7/site-packages/tensorflow_core/python/eager/function.py", line 1224, in _call_flat
    ctx, args, cancellation_manager=cancellation_manager)
  File "/usr/local/lib/python3.7/site-packages/tensorflow_core/python/eager/function.py", line 511, in call
    ctx=ctx)
  File "/usr/local/lib/python3.7/site-packages/tensorflow_core/python/eager/execute.py", line 61, in quick_execute
    num_outputs)
KeyboardInterrupt